{"version":3,"sources":["../../../../widgets/CartoMaintenanceWgt/case/UtilityCase.js"],"names":["define","Deferred","QueryTask","Query","StatisticDefinition","geometryEngine","all","esriRequest","UtilityCase","ubigeoFieldName","platformUpdate","estadoInsValue","estadoValue","codUiValue","Land","ubigeo","codPre","codUi","estado","coordX","coordY","codVer","codCpu","dirMun","dirUrb","ranCpu","tipVia","nomVia","numMun","idMznC","idPred","tipPred","PointLot","idLote","secuen","zonaUtm","estadoIns","Lot","idLotP","anoCart","fuente","nomPc","nomUser","codLot","lotUrb","tipLot","Arancel","secEjec","receptionModelRequest","matchWithReceptionModel","object","modelRequests","response","map","land","arrayMatch","forEach","field","attributes","getFeatureSchema","url","geometry","blankFields","deferred","queryTask","query","where","returnGeometry","outFields","num","execute","then","feature","result","features","prop","resolve","catch","reject","err","promise","attributeTransfer","objTarget","objBase","propsUse","propsOmit","updateOnlyNulls","omitPropsDefault","deletePropsDefault","fieldMatch","propsOmitDefault","propsDeleteDefault","includes","length","props1","Object","keys","props2","filter","hasOwnProperty","getValueCodVer","factor","cod_ver_concatenate","toString","slice","cod_ver","split","reverse","join","digit","index","parseInt","reduce","a","b","getBlockFromLot","queryBlock","queryTaskBlock","checkExistLotUrban","block","urlLots","queryLot","spatialRel","LotCls","queryTaskLot","lotsUrban","attr","lots","lot","exist","some","translateFieldsBlockToLot","lotsResults","graphic","lotIdx","clone","calculateTipLot","currentLotsRows","row","Set","calculateFieldsOfLot","lotUrl","codRequests","user","queryLotTask","statDefIdLoteP","statisticType","onStatisticField","outStatisticFieldName","statDefRanCpu","outStatistics","idx","Date","getFullYear","translateFieldsLotToPointLot","urlPointLots","newPointLotsGraphics","pointLots","pointLot","graph","intersects","pointLotIdx","push","translateFieldsArancelToPointLot","arancelUrl","promises","queryArancelTask","queryArancel","geometryType","element","arancel","arancels","calculateFieldsOfPointLot","pointLotUrl","PointLotCls","queryPointLotTask","queryPointLot","statDef","i","generateCodCpu","generateDirMun","generateDirUrb","translateFieldsPointLotToLand","landUrl","newLandsGraphics","LandCls","lands","landGraphic","landProps","x","y","calculateIdMznC","cadastralBlockUrl","queryCadastralBlockTask","queryCadastralBlock","calculateIdPred","queryLandTask","queryLand","error","getPointLotsOrigin","queryPointLotsOriginTask","queryPointLotsOrigin","distance","units","getLandsOrigin","queryLandsOriginTask","queryLandsOrigin","getDataOrigin","results","setParametersToAddFeatures","params","content","JSON","stringify","f","handleAs","callbackParamName","setParametersToUpdateFeatures","setParametersToDeleteFeatures","sendDataOriginToHistoric","config","currentPoinLotsRows","currentLandsRows","lotsHistoricRequestOptions","lotHistoricUrl","pointsLotsHistoricRequestOptions","pointLotHistoricUrl","landsHistoricRequestOptions","landHistoricUrl","usePost","deleteDataOrigin","objetidLot","OBJECTID","objetidPointLot","objetidLand","lotsDeleteRequestOptions","pointsLotsDeleteRequestOptions","landsDeleteRequestOptions","addDataNew","Array","isArray","lotNews","pointLotsNews","landsNews","updateStatusRequests","caseRequest","responseLands","id","idType","predio","fetch","updateStatusApplication","method","body","headers","json","data","checkLotsWithinLands","checkLands","every"],"mappings":"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","file":"UtilityCase.js","sourcesContent":["define([\r\n    \"dojo/Deferred\",\r\n    \"esri/tasks/QueryTask\",\r\n    \"esri/tasks/query\",\r\n    \"esri/tasks/StatisticDefinition\",\r\n    \"esri/geometry/geometryEngine\",\r\n    \"dojo/promise/all\",\r\n    \"esri/request\"\r\n], function (\r\n    Deferred,\r\n    QueryTask,\r\n    Query,\r\n    StatisticDefinition,\r\n    geometryEngine,\r\n    all,\r\n    esriRequest\r\n) {\r\n    /*\r\n    * @description: Objeto que contiene las funciones para la subdivisi贸n de lotes\r\n    */\r\n    const UtilityCase = {\r\n\r\n        ubigeoFieldName: 'UBIGEO',\r\n        platformUpdate: 'PCF',\r\n        estadoInsValue: 1,\r\n        estadoValue: 1,\r\n        codUiValue: 1,\r\n\r\n        Land() {\r\n            this.ubigeo = 'UBIGEO';\r\n            this.codPre = 'COD_PRE';\r\n            this.codUi = 'COD_UI';\r\n            this.estado = 'ESTADO';\r\n            this.coordX = 'COORD_X';\r\n            this.coordY = 'COORD_Y';\r\n            this.codVer = 'COD_VER';\r\n            this.codCpu = 'COD_CPU';\r\n            this.dirMun = 'DIR_MUN';\r\n            this.dirUrb = 'DIR_URB';\r\n            this.ranCpu = 'RAN_CPU';\r\n            this.tipVia = 'TIP_VIA';\r\n            this.nomVia = 'NOM_VIA';\r\n            this.numMun = 'NUM_MUN';\r\n            this.idMznC = 'ID_MZN_C';\r\n            this.idPred = 'ID_PRED';\r\n            this.tipPred = 'TIP_PRED';\r\n        },\r\n        PointLot() {\r\n            this.ubigeo = 'UBIGEO';\r\n            this.idLote = 'ID_LOTE'\r\n            this.secuen = 'SECUEN';\r\n            this.coordX = 'COORD_X';\r\n            this.coordY = 'COORD_Y';\r\n            this.zonaUtm = 'ZONA_UTM';\r\n            this.estadoIns = 'ESTADO_INS'\r\n        },\r\n        Lot() {\r\n            this.idLotP = 'ID_LOTE_P';\r\n            this.ranCpu = 'RAN_CPU';\r\n            this.anoCart = 'ANO_CART';\r\n            this.fuente = 'FUENTE';\r\n            this.nomPc = 'NOM_PC';\r\n            this.nomUser = 'NOM_USER';\r\n            this.codLot = 'COD_LOTE';\r\n            this.lotUrb = 'LOT_URB';\r\n            this.ubigeo = 'UBIGEO';\r\n            this.tipLot = 'TIP_LOT';\r\n        },\r\n        Arancel() {\r\n            this.secEjec = 'SEC_EJEC';\r\n\r\n        },\r\n\r\n        receptionModelRequest() {\r\n            return [\r\n                \"COD_PRE\",\r\n                \"COD_CPU\",\r\n                \"COD_SECT\",\r\n                \"COD_MZN\",\r\n                \"COD_LOTE\",\r\n                \"COD_UU\",\r\n                \"COD_VIA\",\r\n                \"TIPO_UU\",\r\n                \"NOM_UU\",\r\n                \"NOM_REF\",\r\n                \"MZN_URB\",\r\n                \"LOT_URB\",\r\n                \"TIP_VIA\",\r\n                \"NOM_VIA\",\r\n                \"CUADRA\",\r\n                \"LADO\",\r\n                \"DIR_MUN\",\r\n                \"DIR_URB\",\r\n                \"COORD_X\",\r\n                \"COORD_Y\",\r\n                \"RAN_CPU\",\r\n                \"COD_UI\",\r\n                \"COD_VER\",\r\n            ]\r\n        },\r\n\r\n        matchWithReceptionModel(object) {\r\n            const modelRequests = this.receptionModelRequest();\r\n            const response = object.map((land) => {\r\n                const arrayMatch = {};\r\n                modelRequests.forEach((field) => {\r\n                    arrayMatch[field] = land.attributes[field];\r\n                })\r\n                return arrayMatch;\r\n            })\r\n            return response;\r\n        },\r\n\r\n        getFeatureSchema(url, geometry = true, blankFields = true) {\r\n            const deferred = new Deferred();\r\n            const queryTask = new QueryTask(url);\r\n            const query = new Query();\r\n            query.where = \"1=1\";\r\n            query.returnGeometry = geometry;\r\n            query.outFields = [\"*\"];\r\n            query.num = 1;\r\n            queryTask.execute(query)\r\n                .then(result => {\r\n                    const feature = result.features[0];\r\n                    if (blankFields) {\r\n                        for (let prop in feature.attributes) {\r\n                            feature.attributes[prop] = null;\r\n                        }\r\n                    }\r\n                    return deferred.resolve(feature);\r\n                })\r\n                .catch(err => {\r\n                    deferred.reject(err);\r\n                });\r\n            return deferred.promise;\r\n        },\r\n\r\n        attributeTransfer({ objTarget, objBase, propsUse = [], propsOmit = [], updateOnlyNulls = false, omitPropsDefault = true, deletePropsDefault = true }) {\r\n            let fieldMatch = []\r\n            const propsOmitDefault = [\r\n                'FUENTE',\r\n                'NOM_PC',\r\n                'NOM_USER',\r\n                'ANO_CART'\r\n            ]\r\n            const propsDeleteDefault = [\r\n                'OBJECTID',\r\n                'GlobalID',\r\n                'created_date',\r\n                'created_user',\r\n                'last_edited_date',\r\n                'last_edited_user',\r\n                'Shape.STArea()',\r\n                'Shape.STLength()',\r\n            ];\r\n\r\n            if (deletePropsDefault) {\r\n                for (let prop in objTarget) {\r\n                    if (propsDeleteDefault.includes(prop)) {\r\n                        delete objTarget[prop];\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (propsUse.length > 0) {\r\n                fieldMatch = propsUse\r\n            } else {\r\n                const props1 = Object.keys(objTarget);\r\n                const props2 = Object.keys(objBase);\r\n                fieldMatch = props1.filter(prop => props2.includes(prop));\r\n            }\r\n            // retirar los campos omitidos\r\n            if (propsOmit.length > 0) {\r\n                fieldMatch = fieldMatch.filter(prop => !propsOmit.includes(prop));\r\n            }\r\n\r\n            // retirar los campos omitidos por defecto de objBase\r\n            if (omitPropsDefault) {\r\n                fieldMatch = fieldMatch.filter(prop => !propsOmitDefault.includes(prop));\r\n            }\r\n\r\n            fieldMatch.forEach(prop => {\r\n                if (objBase.hasOwnProperty(prop)) {\r\n                    if (updateOnlyNulls) {\r\n                        if (objTarget[prop] === null) {\r\n                            objTarget[prop] = objBase[prop];\r\n                        }\r\n                    } else {\r\n                        objTarget[prop] = objBase[prop];\r\n                    }\r\n                }\r\n            });\r\n\r\n            return objTarget;\r\n        },\r\n\r\n        getValueCodVer(ranCpu, codUi) {\r\n            const factor = [2, 3, 4, 5, 6, 7, 2, 3, 4, 5, 6, 7]\r\n            // Obteniendo c贸digo concatenado\r\n            const cod_ver_concatenate = ranCpu.toString() + (\"0000\" + codUi.toString()).slice(-4);\r\n\r\n            // Reversa de c贸digo concatenado\r\n            const cod_ver = cod_ver_concatenate.split('').reverse().join('');\r\n\r\n            // Aplicando f贸rmula\r\n            let response = 11 - (cod_ver.split('').map((digit, index) =>\r\n                parseInt(digit) * factor[index])\r\n                .reduce((a, b) => a + b, 0) % 11);\r\n\r\n            if (response > 9) {\r\n                response = 11 - response;\r\n            }\r\n\r\n            return response\r\n        },\r\n\r\n        getBlockFromLot(geometry, url) {\r\n            const deferred = new Deferred();\r\n\r\n            const queryBlock = new Query();\r\n            queryBlock.geometry = geometry;\r\n            queryBlock.outFields = ['*'];\r\n            queryBlock.returnGeometry = true;\r\n            const queryTaskBlock = new QueryTask(url);\r\n            queryTaskBlock.execute(queryBlock)\r\n                .then(response => {\r\n                    if (response.features.length === 0) {\r\n                        return deferred.reject(\"No se encontraron manzanas\");\r\n                    }\r\n                    return deferred.resolve(response.features[0]);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n\r\n            return deferred.promise;\r\n        },\r\n\r\n        checkExistLotUrban(attributes, block, urlLots) {\r\n            const deferred = new Deferred();\r\n            const queryLot = new Query();\r\n            queryLot.geometry = block.geometry\r\n            queryLot.spatialRel = \"within\";\r\n            const LotCls = new this.Lot();\r\n            queryLot.outFields = [LotCls.lotUrb];\r\n            const queryTaskLot = new QueryTask(urlLots);\r\n            const lotsUrban = attributes.map(attr => attr.lotUrb);\r\n            queryTaskLot.execute(queryLot)\r\n                .then(response => {\r\n                    const lots = response.features.map(lot => lot.attributes[LotCls.lotUrb]);\r\n                    const exist = lotsUrban.some(lot => lots.includes(lot));\r\n                    if (exist) {\r\n                        return deferred.reject(\"Los lotes urbanos registrados ya se encuentran en la manzana actual\");\r\n                    }\r\n                    return deferred.resolve(block);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        translateFieldsBlockToLot(url, block, lotsResults) {\r\n            const deferred = new Deferred();\r\n\r\n            this.getFeatureSchema(url)\r\n                .then(lot => {\r\n                    const lots = lotsResults.map((graphic) => {\r\n                        const lotIdx = lot.clone();\r\n                        lotIdx.attributes = this.attributeTransfer({\r\n                            objTarget: lotIdx.attributes,\r\n                            objBase: block.attributes,\r\n                        });\r\n                        lotIdx.geometry = graphic.geometry;\r\n                        return lotIdx;\r\n                    });\r\n                    return deferred.resolve(lots);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n\r\n            return deferred.promise;\r\n        },\r\n\r\n        calculateTipLot(currentLotsRows) {\r\n            const LotCls = new this.Lot();\r\n            let tipLot = currentLotsRows.map(row => { return row.attributes[LotCls.tipLot] })\r\n            tipLot = [...new Set(tipLot)] == [2] ? '2' : '1'\r\n            return tipLot\r\n        },\r\n\r\n        calculateFieldsOfLot(lotUrl, lots, ubigeo, codRequests, user, attributes, tipLot) {\r\n            // console.log(attributes)\r\n            const deferred = new Deferred();\r\n            const LotCls = new this.Lot();\r\n\r\n            const queryLotTask = new QueryTask(lotUrl);\r\n\r\n            const queryLot = new Query();\r\n\r\n            queryLot.where = `${this.ubigeoFieldName} = '${ubigeo}'`;\r\n\r\n            const statDefIdLoteP = new StatisticDefinition();\r\n            statDefIdLoteP.statisticType = \"max\";\r\n            statDefIdLoteP.onStatisticField = LotCls.idLotP;\r\n            statDefIdLoteP.outStatisticFieldName = `${LotCls.idLotP}_MAX`;\r\n\r\n            const statDefRanCpu = new StatisticDefinition();\r\n            statDefRanCpu.statisticType = \"max\";\r\n            statDefRanCpu.onStatisticField = LotCls.ranCpu;\r\n            statDefRanCpu.outStatisticFieldName = `${LotCls.ranCpu}_MAX`;\r\n\r\n            queryLot.returnGeometry = false;\r\n            queryLot.outStatistics = [statDefIdLoteP, statDefRanCpu];\r\n\r\n            queryLotTask.execute(queryLot)\r\n                .then(response => {\r\n                    lots.forEach((lot, idx) => {\r\n                        lot.attributes[LotCls.idLotP] = response.features[0].attributes[statDefIdLoteP.outStatisticFieldName] + idx + 1;\r\n                        lot.attributes[LotCls.ranCpu] = response.features[0].attributes[statDefRanCpu.outStatisticFieldName] + idx + 1;\r\n                        lot.attributes[LotCls.anoCart] = new Date().getFullYear();\r\n                        lot.attributes[LotCls.fuente] = codRequests;\r\n                        lot.attributes[LotCls.nomPc] = this.platformUpdate;\r\n                        lot.attributes[LotCls.nomUser] = user;\r\n                        lot.attributes[LotCls.codLot] = attributes[idx].codLot;\r\n                        lot.attributes[LotCls.lotUrb] = attributes[idx].lotUrb;\r\n                        lot.attributes[LotCls.tipLot] = tipLot;\r\n                    });\r\n                    return deferred.resolve(lots);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        translateFieldsLotToPointLot(lots, urlPointLots, newPointLotsGraphics) {\r\n            const deferred = new Deferred();\r\n            const pointLots = [];\r\n\r\n            this.getFeatureSchema(urlPointLots)\r\n                .then(pointLot => {\r\n                    lots.forEach(lot => {\r\n                        pointLot.attributes = this.attributeTransfer({\r\n                            objTarget: pointLot.attributes,\r\n                            objBase: lot.attributes,\r\n                            omitPropsDefault: false,\r\n                            deletePropsDefault: true\r\n                        });\r\n\r\n                        for (let graph of newPointLotsGraphics) {\r\n                            if (!geometryEngine.intersects(lot.geometry, graph.geometry)) {\r\n                                continue;\r\n                            }\r\n\r\n                            const pointLotIdx = pointLot.clone();\r\n                            pointLotIdx.geometry = graph.geometry;\r\n                            pointLots.push(pointLotIdx);\r\n                        };\r\n                    });\r\n                    return deferred.resolve(pointLots);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        translateFieldsArancelToPointLot(pointLots, arancelUrl) {\r\n            const deferred = new Deferred();\r\n            const promises = pointLots.map(pointLot => {\r\n                const queryArancelTask = new QueryTask(arancelUrl);\r\n                const queryArancel = new Query();\r\n                queryArancel.returnGeometry = true;\r\n                queryArancel.outFields = [\"*\"];\r\n                queryArancel.geometry = pointLot.geometry;\r\n                queryArancel.geometryType = \"esriGeometryPoint\";\r\n                return queryArancelTask.execute(queryArancel);\r\n            });\r\n            all(promises)\r\n                .then(arancels => {\r\n                    pointLots.forEach((element, index) => {\r\n                        const arancel = arancels[index].features[0].attributes;\r\n                        pointLots[index].attributes = this.attributeTransfer({\r\n                            objTarget: element.attributes,\r\n                            objBase: arancel,\r\n                            updateOnlyNulls: true\r\n                        });\r\n                        return deferred.resolve(pointLots);\r\n                    });\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        calculateFieldsOfPointLot(pointLotUrl, ubigeo, pointLots) {\r\n            const deferred = new Deferred();\r\n            const PointLotCls = new this.PointLot();\r\n\r\n            const queryPointLotTask = new QueryTask(pointLotUrl);\r\n\r\n            const queryPointLot = new Query();\r\n            queryPointLot.where = `${PointLotCls.ubigeo} = '${ubigeo}'`\r\n            const statDef = new StatisticDefinition();\r\n            statDef.statisticType = \"max\";\r\n            statDef.onStatisticField = PointLotCls.secuen;\r\n            statDef.outStatisticFieldName = `${PointLotCls.secuen}_MAX`;\r\n\r\n            queryPointLot.returnGeometry = false;\r\n            queryPointLot.outStatistics = [statDef];\r\n\r\n            queryPointLotTask.execute(queryPointLot)\r\n                .then(response => {\r\n                    let secuen = response.features[0].attributes[statDef.outStatisticFieldName] + 1\r\n                    for (let i of pointLots) {\r\n                        i.attributes[PointLotCls.secuen] = secuen;\r\n                        i.attributes[PointLotCls.idLote] = `${i.attributes[PointLotCls.zonaUtm]}${ubigeo}${secuen}`;\r\n                        i.attributes[PointLotCls.estadoIns] = this.estadoInsValue;\r\n                        secuen += 1;\r\n                    }\r\n                    return deferred.resolve(pointLots);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        generateCodCpu(ranCpu, codVer, codUi = 1) {\r\n            codUi = (\"0000\" + codUi.toString()).slice(-4);\r\n            return `${ranCpu}-${codUi}-${codVer}`;\r\n        },\r\n\r\n        generateDirMun(tipVia, nomVia, numMun) {\r\n            return `${tipVia} ${nomVia} ${numMun}`;\r\n        },\r\n\r\n        generateDirUrb(tipVia, nomVia, numMun) {\r\n            return `${tipVia} ${nomVia} ${numMun}`;\r\n        },\r\n\r\n        translateFieldsPointLotToLand(pointLots, landUrl, newLandsGraphics) {\r\n            const deferred = new Deferred();\r\n            const LandCls = new this.Land();\r\n            let lands = [];\r\n\r\n            this.getFeatureSchema(landUrl)\r\n                .then(land => {\r\n                    newLandsGraphics.forEach(landGraphic => {\r\n                        for (i = 0; i < pointLots.length; i++) {\r\n                            if (geometryEngine.intersects(landGraphic.geometry, pointLots[i].geometry)) {\r\n                                const landProps = land.clone();\r\n                                landProps.attributes = this.attributeTransfer({\r\n                                    objTarget: land.attributes,\r\n                                    objBase: pointLots[i].attributes,\r\n                                    omitPropsDefault: false\r\n                                });\r\n                                landProps.attributes[LandCls.codPre] = landGraphic.codPre;\r\n                                landProps.attributes[LandCls.codUi] = this.codUiValue;\r\n                                landProps.attributes[LandCls.estado] = this.estadoValue;\r\n                                landProps.attributes[LandCls.coordX] = landGraphic.geometry.x;\r\n                                landProps.attributes[LandCls.coordY] = landGraphic.geometry.y;\r\n                                landProps.attributes[LandCls.codVer] = this.getValueCodVer(\r\n                                    landProps.attributes[LandCls.ranCpu],\r\n                                    this.codUiValue\r\n                                );\r\n                                landProps.attributes[LandCls.codCpu] = this.generateCodCpu(\r\n                                    landProps.attributes[LandCls.ranCpu],\r\n                                    landProps.attributes[LandCls.codVer]\r\n                                );\r\n                                landProps.attributes[LandCls.dirMun] = this.generateDirMun(\r\n                                    landProps.attributes[LandCls.tipVia],\r\n                                    landProps.attributes[LandCls.nomVia],\r\n                                    landProps.attributes[LandCls.numMun]\r\n                                );\r\n                                landProps.attributes[LandCls.dirUrb] = this.generateDirUrb(\r\n                                    landProps.attributes[LandCls.tipVia],\r\n                                    landProps.attributes[LandCls.nomVia],\r\n                                    landProps.attributes[LandCls.numMun]\r\n                                );\r\n                                landProps.geometry = landGraphic.geometry;\r\n                                lands.push(landProps.clone());\r\n                                break;\r\n                            }\r\n                        }\r\n                    });\r\n                    return deferred.resolve(lands);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        calculateIdMznC(lands, cadastralBlockUrl, ubigeo) {\r\n            const deferred = new Deferred();\r\n            const LandCls = new this.Land();\r\n\r\n            const queryCadastralBlockTask = new QueryTask(cadastralBlockUrl);\r\n            const queryCadastralBlock = new Query();\r\n            queryCadastralBlock.where = `${LandCls.ubigeo} = '${ubigeo}'`;\r\n            queryCadastralBlock.returnGeometry = true;\r\n            queryCadastralBlock.outFields = [LandCls.idMznC];\r\n            queryCadastralBlock.geometry = lands[0].geometry;\r\n\r\n            queryCadastralBlockTask.execute(queryCadastralBlock)\r\n                .then(response => {\r\n                    lands.forEach(land => {\r\n                        land.attributes[LandCls.idMznC] = response.features[0].attributes[LandCls.idMznC];\r\n                    });\r\n                    return deferred.resolve(lands);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        calculateIdPred(lands, landUrl, ubigeo) {\r\n            const deferred = new Deferred();\r\n            const LandCls = new this.Land();\r\n\r\n            const queryLandTask = new QueryTask(landUrl);\r\n            const queryLand = new Query();\r\n            queryLand.returnGeometry = false;\r\n            queryLand.where = `${LandCls.ubigeo} = '${ubigeo}'`\r\n            const statDef = new StatisticDefinition();\r\n            statDef.statisticType = \"max\";\r\n            statDef.onStatisticField = LandCls.idPred;\r\n            statDef.outStatisticFieldName = `${LandCls.idPred}_MAX`;\r\n            queryLand.outStatistics = [statDef];\r\n\r\n            queryLandTask.execute(queryLand)\r\n                .then(function (response) {\r\n                    lands.forEach((land, idx) => {\r\n                        land.attributes[LandCls.idPred] = response.features[0].attributes[statDef.outStatisticFieldName] + idx + 1;\r\n                    });\r\n                    return deferred.resolve(lands);\r\n                }, function (error) {\r\n                    deferred.reject(error);\r\n                });\r\n            return deferred.promise;\r\n        },\r\n\r\n        getPointLotsOrigin(pointLotUrl, lots) {\r\n            const queryPointLotsOriginTask = new QueryTask(pointLotUrl);\r\n            const queryPointLotsOrigin = new Query();\r\n            queryPointLotsOrigin.returnGeometry = true;\r\n            queryPointLotsOrigin.outFields = [\"*\"];\r\n            queryPointLotsOrigin.geometry = lots.geometry;\r\n            queryPointLotsOrigin.geometryType = \"esriGeometryPolygon\";\r\n            queryPointLotsOrigin.distance = 0.5;\r\n            queryPointLotsOrigin.units = \"meters\";\r\n            return queryPointLotsOriginTask.execute(queryPointLotsOrigin);\r\n        },\r\n\r\n        getLandsOrigin(landUrl, lots) {\r\n            const queryLandsOriginTask = new QueryTask(landUrl);\r\n            const queryLandsOrigin = new Query();\r\n            queryLandsOrigin.returnGeometry = true;\r\n            queryLandsOrigin.outFields = [\"*\"];\r\n            queryLandsOrigin.geometry = lots.geometry;\r\n            queryLandsOrigin.geometryType = \"esriGeometryPolygon\";\r\n            queryLandsOrigin.distance = 0.5;\r\n            queryLandsOrigin.units = \"meters\";\r\n            return queryLandsOriginTask.execute(queryLandsOrigin);\r\n        },\r\n\r\n        getDataOrigin(pointLotUrl, landUrl, lots) {\r\n            // const self = this;\r\n            const deferred = new Deferred();\r\n\r\n            const promises = [\r\n                this.getPointLotsOrigin(pointLotUrl, lots),\r\n                this.getLandsOrigin(landUrl, lots)\r\n            ]\r\n\r\n            all(promises)\r\n                .then(results => {\r\n                    // self.currentPoinLotsRows = results[0].features;\r\n                    // self.currentLandsRows = results[1].features;\r\n                    return deferred.resolve(results);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        setParametersToAddFeatures(url, params) {\r\n            return {\r\n                url: `${url}/addFeatures`,\r\n                content: {\r\n                    features: JSON.stringify(params),\r\n                    f: \"json\"\r\n                },\r\n                handleAs: \"json\",\r\n                callbackParamName: \"callback\"\r\n            };\r\n        },\r\n\r\n        setParametersToUpdateFeatures(url, params) {\r\n            return {\r\n                url: `${url}/updateFeatures`,\r\n                content: {\r\n                    features: JSON.stringify(params),\r\n                    f: \"json\"\r\n                },\r\n                handleAs: \"json\",\r\n                callbackParamName: \"callback\"\r\n            };\r\n        },\r\n\r\n        setParametersToDeleteFeatures(url, params) {\r\n            return {\r\n                url: `${url}/deleteFeatures`,\r\n                content: {\r\n                    where: params,\r\n                    f: \"json\"\r\n                },\r\n                handleAs: \"json\",\r\n                callbackParamName: \"callback\"\r\n            };\r\n        },\r\n\r\n        sendDataOriginToHistoric(config, currentLotsRows, currentPoinLotsRows, currentLandsRows) {\r\n            const deferred = new Deferred();\r\n            const lotsHistoricRequestOptions = this.setParametersToAddFeatures(\r\n                config.lotHistoricUrl,\r\n                currentLotsRows\r\n            );\r\n            const pointsLotsHistoricRequestOptions = this.setParametersToAddFeatures(\r\n                config.pointLotHistoricUrl,\r\n                currentPoinLotsRows\r\n            );\r\n            const landsHistoricRequestOptions = this.setParametersToAddFeatures(\r\n                config.landHistoricUrl,\r\n                currentLandsRows\r\n            );\r\n            const promises = [\r\n                esriRequest(lotsHistoricRequestOptions, { usePost: true }),\r\n                esriRequest(pointsLotsHistoricRequestOptions, { usePost: true }),\r\n                esriRequest(landsHistoricRequestOptions, { usePost: true })\r\n            ]\r\n\r\n            all(promises)\r\n                .then(results => {\r\n                    return deferred.resolve(results);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        deleteDataOrigin(currentLotsRows, currentPoinLotsRows, currentLandsRows, config) {\r\n            const deferred = new Deferred();\r\n\r\n            const objetidLot = currentLotsRows.map(row => row.attributes.OBJECTID);\r\n            const objetidPointLot = currentPoinLotsRows.map(row => row.attributes.OBJECTID);\r\n            const objetidLand = currentLandsRows.map(row => row.attributes.OBJECTID);\r\n\r\n            const lotsDeleteRequestOptions = this.setParametersToDeleteFeatures(\r\n                config.lotUrl,\r\n                `OBJECTID IN (${objetidLot.join(\",\")})`,\r\n            );\r\n            const pointsLotsDeleteRequestOptions = this.setParametersToDeleteFeatures(\r\n                config.pointLotUrl,\r\n                `OBJECTID IN (${objetidPointLot.join(\",\")})`,\r\n            );\r\n            const landsDeleteRequestOptions = this.setParametersToDeleteFeatures(\r\n                config.landUrl,\r\n                `OBJECTID IN (${objetidLand.join(\",\")})`,\r\n            );\r\n\r\n            const promises = [\r\n                esriRequest(lotsDeleteRequestOptions, { usePost: true }),\r\n                esriRequest(pointsLotsDeleteRequestOptions, { usePost: true }),\r\n                esriRequest(landsDeleteRequestOptions, { usePost: true })\r\n            ]\r\n\r\n            all(promises)\r\n                .then(results => {\r\n                    return deferred.resolve(results);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        addDataNew(lots, pointLots, lands, config) {\r\n            const deferred = new Deferred();\r\n\r\n            lots = Array.isArray(lots) ? lots : [lots]\r\n\r\n            const lotNews = this.setParametersToAddFeatures(\r\n                config.lotUrl,\r\n                lots\r\n            );\r\n\r\n            pointLots = Array.isArray(pointLots) ? pointLots : [pointLots]\r\n\r\n            const pointLotsNews = this.setParametersToAddFeatures(\r\n                config.pointLotUrl,\r\n                pointLots\r\n            );\r\n\r\n            lands = Array.isArray(lands) ? lands : [lands]\r\n\r\n            const landsNews = this.setParametersToAddFeatures(\r\n                config.landUrl,\r\n                lands\r\n            );\r\n\r\n            const promises = [\r\n                esriRequest(lotNews, { usePost: true }),\r\n                esriRequest(pointLotsNews, { usePost: true }),\r\n                esriRequest(landsNews, { usePost: true })\r\n            ]\r\n\r\n            all(promises)\r\n                .then(results => {\r\n                    return deferred.resolve(results);\r\n                })\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        updateStatusRequests(lands, codRequests, caseRequest, ubigeo, config) {\r\n            const deferred = new Deferred();\r\n            const responseLands = UtilityCase.matchWithReceptionModel(lands)\r\n            let response = {\r\n                id: codRequests,\r\n                results: responseLands,\r\n                idType: parseInt(caseRequest)\r\n            }\r\n            for (let predio of response.results) {\r\n                predio['ubigeo'] = ubigeo;\r\n            }\r\n\r\n            fetch(config.updateStatusApplication, {\r\n                method: 'POST',\r\n                body: JSON.stringify(response),\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                }\r\n            })\r\n                .then(response => response.json())\r\n                .then(data => deferred.resolve(data))\r\n                .catch(err => deferred.reject(err));\r\n            return deferred.promise;\r\n        },\r\n\r\n        checkLotsWithinLands(lots, lands) {\r\n            for (let lot of lots) {\r\n                const checkLands = []\r\n                for (let land of lands) {\r\n                    checkLands.push(geometryEngine.intersects(lot.geometry, land.geometry))\r\n                }\r\n                if (checkLands.every(i => i === false)) {\r\n                    return false\r\n                }\r\n            }\r\n            return true\r\n        },\r\n\r\n    };\r\n\r\n    return UtilityCase;\r\n});"]}